/opt/conda/lib/python3.8/site-packages/MinkowskiEngine-0.5.4-py3.8-linux-x86_64.egg/MinkowskiEngine/__init__.py:36: UserWarning: The environment variable `OMP_NUM_THREADS` not set. MinkowskiEngine will automatically set `OMP_NUM_THREADS=16`. If you want to set `OMP_NUM_THREADS` manually, please export it on the command line before running a python script. e.g. `export OMP_NUM_THREADS=12; python your_program.py`. It is recommended to set it below 24.
  warnings.warn(
Training config path: ../config/config_baseline.txt
Model config path: ../models/minkloc_config.txt
Debug mode: False
Visualize: False
Parameters:
params_path: ../config/config_baseline.txt
model_params_path: ../models/minkloc_config.txt
num_points: 4096
max_distance: 300
dataset_name: TUM
dataset_folder: ../../datasets/frame_5m_unnormalized
num_workers: 4
batch_size: 16
batch_expansion_th: 0.7
batch_size_limit: 158
batch_expansion_rate: 1.4
lr: 0.001
scheduler: MultiStepLR
scheduler_milestones: [30]
epochs: 40
weight_decay: 0.001
normalize_embeddings: False
loss: BatchHardTripletMarginLoss
margin: 0.2
aug_mode: 1
train_file: tum_training_queries_frame_5m_baseline.pickle
val_file: None
eval_database_files: ['tum_evaluation_frame_5m_database.pickle']
eval_query_files: ['tum_evaluation_frame_5m_query.pickle']
Model parameters:
model_params_path: ../models/minkloc_config.txt
model: MinkFPN_GeM
output_dim: 256
mink_quantization_size: [2.5, 2.0, 1.875]
version: MinkLoc3D-S
feature_size: 256
planes: [32, 64, 64]
combine_params: {'with_pnt': True, 'with_crosatt': False, 'with_way': 'cat', 'before_pooling': True}
layers: [1, 1, 1]
num_top_down: 1
conv0_kernel_size: 5


Loading preprocessed query file: ../../datasets/frame_5m_unnormalized/tum_training_queries_frame_5m_baseline_cached.pickle...
667 queries in the dataset
Model name: model_MinkFPN_GeM_20220529_1849
Model class: MinkLoc
Total parameters: 3759274
Backbone parameters: 1055712
Aggregation parameters: 1
Model device: cuda
  0%|                                                    | 0/40 [00:00<?, ?it/s]train - Mean loss: 1.682931    Avg. embedding norm: 31.9693   Triplets per batch (all/non-zero): 15.7/6.0
Pos dist (min/mean/max): 3.6658/5.7758/10.2974   Neg dist (min/mean/max): 4.6302/6.4881/11.8016
=> Batch size increased from: 16 to 22
  2%|█                                           | 1/40 [00:42<27:46, 42.74s/it]train - Mean loss: 1.037583    Avg. embedding norm: 33.5996   Triplets per batch (all/non-zero): 22.0/5.9
Pos dist (min/mean/max): 3.4967/5.3324/8.1462   Neg dist (min/mean/max): 4.7796/6.5939/10.1069
=> Batch size increased from: 22 to 30
  5%|██▏                                         | 2/40 [01:13<22:31, 35.57s/it]train - Mean loss: 1.092196    Avg. embedding norm: 33.3319   Triplets per batch (all/non-zero): 29.8/6.0
Pos dist (min/mean/max): 3.3977/5.3700/8.7520   Neg dist (min/mean/max): 5.0900/7.1510/11.6716
=> Batch size increased from: 30 to 42
  8%|███▎                                        | 3/40 [01:35<18:12, 29.52s/it]train - Mean loss: 1.122516    Avg. embedding norm: 33.0738   Triplets per batch (all/non-zero): 40.0/8.5
Pos dist (min/mean/max): 3.3147/5.3049/8.6976   Neg dist (min/mean/max): 4.7896/6.7412/10.2620
=> Batch size increased from: 42 to 58
 10%|████▍                                       | 4/40 [01:56<15:43, 26.21s/it]train - Mean loss: 0.997609    Avg. embedding norm: 32.6632   Triplets per batch (all/non-zero): 56.6/12.5
Pos dist (min/mean/max): 3.1667/5.2174/9.2009   Neg dist (min/mean/max): 4.6123/6.5987/10.2000
=> Batch size increased from: 58 to 81
 12%|█████▌                                      | 5/40 [02:15<13:46, 23.63s/it]train - Mean loss: 1.000829    Avg. embedding norm: 32.0359   Triplets per batch (all/non-zero): 81.1/25.1
Pos dist (min/mean/max): 3.0753/5.1940/10.2185   Neg dist (min/mean/max): 4.0285/6.2881/10.1141
=> Batch size increased from: 81 to 113
 15%|██████▌                                     | 6/40 [02:34<12:29, 22.04s/it]train - Mean loss: 1.167833    Avg. embedding norm: 31.3424   Triplets per batch (all/non-zero): 102.6/31.9
Pos dist (min/mean/max): 2.8529/5.2313/10.2027   Neg dist (min/mean/max): 4.3382/6.2136/10.6321
=> Batch size increased from: 113 to 158
 18%|███████▋                                    | 7/40 [02:52<11:23, 20.71s/it]train - Mean loss: 0.922588    Avg. embedding norm: 31.3404   Triplets per batch (all/non-zero): 145.2/42.8
Pos dist (min/mean/max): 2.8910/5.0430/8.6833   Neg dist (min/mean/max): 4.0223/5.9012/8.4943
 20%|████████▊                                   | 8/40 [03:11<10:42, 20.09s/it]train - Mean loss: 1.110493    Avg. embedding norm: 30.8346   Triplets per batch (all/non-zero): 145.2/37.2
Pos dist (min/mean/max): 2.8064/5.0616/10.4557   Neg dist (min/mean/max): 4.1836/6.0174/8.8216
 22%|█████████▉                                  | 9/40 [03:29<10:06, 19.56s/it]train - Mean loss: 0.856975    Avg. embedding norm: 30.8562   Triplets per batch (all/non-zero): 144.4/35.4
Pos dist (min/mean/max): 2.9755/4.9243/9.9894   Neg dist (min/mean/max): 4.3271/5.8727/8.5701
 25%|██████████▊                                | 10/40 [03:48<09:35, 19.18s/it]train - Mean loss: 0.926718    Avg. embedding norm: 30.8677   Triplets per batch (all/non-zero): 145.2/33.6
Pos dist (min/mean/max): 2.7952/4.9697/8.7895   Neg dist (min/mean/max): 4.3172/5.9928/8.1842
 28%|███████████▊                               | 11/40 [04:05<09:01, 18.68s/it]train - Mean loss: 0.910350    Avg. embedding norm: 30.3970   Triplets per batch (all/non-zero): 146.8/40.8
Pos dist (min/mean/max): 2.6736/4.8840/9.5071   Neg dist (min/mean/max): 4.0513/5.7392/8.0435
 30%|████████████▉                              | 12/40 [04:23<08:35, 18.41s/it]train - Mean loss: 0.884998    Avg. embedding norm: 30.1815   Triplets per batch (all/non-zero): 144.0/34.4
Pos dist (min/mean/max): 2.7087/4.8855/9.5075   Neg dist (min/mean/max): 4.2429/5.9256/9.1007
 32%|█████████████▉                             | 13/40 [04:41<08:12, 18.25s/it]train - Mean loss: 0.784549    Avg. embedding norm: 30.4837   Triplets per batch (all/non-zero): 144.8/32.2
Pos dist (min/mean/max): 2.7103/4.8155/8.5922   Neg dist (min/mean/max): 4.5446/5.9381/8.4043
 35%|███████████████                            | 14/40 [04:58<07:47, 18.00s/it]train - Mean loss: 0.991058    Avg. embedding norm: 30.3163   Triplets per batch (all/non-zero): 145.2/27.0
Pos dist (min/mean/max): 2.8416/4.8285/8.8725   Neg dist (min/mean/max): 4.3177/6.0731/9.1183
 38%|████████████████▏                          | 15/40 [05:17<07:31, 18.08s/it]train - Mean loss: 0.714556    Avg. embedding norm: 29.9360   Triplets per batch (all/non-zero): 144.4/26.2
Pos dist (min/mean/max): 2.7190/4.7910/8.4169   Neg dist (min/mean/max): 4.3670/6.0401/8.1057
 40%|█████████████████▏                         | 16/40 [05:37<07:27, 18.66s/it]train - Mean loss: 0.628504    Avg. embedding norm: 30.0497   Triplets per batch (all/non-zero): 146.0/18.2
Pos dist (min/mean/max): 2.6445/4.6734/8.8435   Neg dist (min/mean/max): 4.5642/6.1430/8.3635
 42%|██████████████████▎                        | 17/40 [05:55<07:07, 18.61s/it]train - Mean loss: 0.892284    Avg. embedding norm: 29.8409   Triplets per batch (all/non-zero): 145.2/24.6
Pos dist (min/mean/max): 2.6739/4.7506/8.7195   Neg dist (min/mean/max): 4.1971/5.9894/8.4416
 45%|███████████████████▎                       | 18/40 [06:14<06:53, 18.81s/it]train - Mean loss: 0.743239    Avg. embedding norm: 30.3447   Triplets per batch (all/non-zero): 142.4/32.6
Pos dist (min/mean/max): 2.7938/4.8429/8.3362   Neg dist (min/mean/max): 4.3463/6.0123/8.5038
 48%|████████████████████▍                      | 19/40 [06:33<06:32, 18.70s/it]train - Mean loss: 0.628964    Avg. embedding norm: 29.7167   Triplets per batch (all/non-zero): 144.4/25.4
Pos dist (min/mean/max): 2.5825/4.7451/7.8629   Neg dist (min/mean/max): 4.2761/6.0434/8.4819
 50%|█████████████████████▌                     | 20/40 [06:51<06:09, 18.50s/it]train - Mean loss: 0.882497    Avg. embedding norm: 29.1763   Triplets per batch (all/non-zero): 144.0/31.0
Pos dist (min/mean/max): 2.6126/4.9140/9.7142   Neg dist (min/mean/max): 4.5452/6.0849/8.8647
 52%|██████████████████████▌                    | 21/40 [07:09<05:49, 18.39s/it]train - Mean loss: 0.709530    Avg. embedding norm: 29.9807   Triplets per batch (all/non-zero): 144.8/22.6
Pos dist (min/mean/max): 2.7205/4.7805/8.8980   Neg dist (min/mean/max): 4.2529/6.1243/8.7038
 55%|███████████████████████▋                   | 22/40 [07:27<05:30, 18.35s/it]train - Mean loss: 0.643225    Avg. embedding norm: 29.9576   Triplets per batch (all/non-zero): 143.6/15.4
Pos dist (min/mean/max): 2.7454/4.6404/7.9232   Neg dist (min/mean/max): 4.3363/6.2581/8.8861
 57%|████████████████████████▋                  | 23/40 [07:45<05:11, 18.32s/it]train - Mean loss: 0.781019    Avg. embedding norm: 30.0291   Triplets per batch (all/non-zero): 145.6/20.6
Pos dist (min/mean/max): 2.8777/4.7321/8.5937   Neg dist (min/mean/max): 4.3842/6.0857/8.2585
 60%|█████████████████████████▊                 | 24/40 [08:04<04:54, 18.39s/it]train - Mean loss: 0.803130    Avg. embedding norm: 29.9495   Triplets per batch (all/non-zero): 142.8/21.6
Pos dist (min/mean/max): 2.7201/4.7273/8.5800   Neg dist (min/mean/max): 4.3321/6.1432/8.7981
 62%|██████████████████████████▉                | 25/40 [08:23<04:37, 18.47s/it]train - Mean loss: 0.552157    Avg. embedding norm: 29.9371   Triplets per batch (all/non-zero): 144.8/15.6
Pos dist (min/mean/max): 2.7846/4.6750/7.7897   Neg dist (min/mean/max): 4.1972/6.1623/8.5138
 65%|███████████████████████████▉               | 26/40 [08:41<04:16, 18.29s/it]train - Mean loss: 0.547857    Avg. embedding norm: 29.9581   Triplets per batch (all/non-zero): 143.6/21.2
Pos dist (min/mean/max): 2.6074/4.7035/7.6689   Neg dist (min/mean/max): 4.2627/6.1641/8.6126
 68%|█████████████████████████████              | 27/40 [08:58<03:55, 18.11s/it]train - Mean loss: 0.656219    Avg. embedding norm: 29.9834   Triplets per batch (all/non-zero): 145.2/16.8
Pos dist (min/mean/max): 2.6630/4.7271/7.6391   Neg dist (min/mean/max): 4.5559/6.3740/8.5264
 70%|██████████████████████████████             | 28/40 [09:16<03:36, 18.03s/it]train - Mean loss: 0.669807    Avg. embedding norm: 30.0037   Triplets per batch (all/non-zero): 147.2/18.4
Pos dist (min/mean/max): 2.8417/4.8368/8.9000   Neg dist (min/mean/max): 4.5692/6.4369/8.9215
 72%|███████████████████████████████▏           | 29/40 [09:34<03:18, 18.00s/it]train - Mean loss: 0.679241    Avg. embedding norm: 29.6818   Triplets per batch (all/non-zero): 143.6/23.6
Pos dist (min/mean/max): 2.6123/4.8794/8.3481   Neg dist (min/mean/max): 4.5554/6.4450/8.9495
 75%|████████████████████████████████▎          | 30/40 [09:52<02:59, 17.99s/it]train - Mean loss: 0.712883    Avg. embedding norm: 29.5792   Triplets per batch (all/non-zero): 144.0/19.6
Pos dist (min/mean/max): 2.6926/4.7667/8.3689   Neg dist (min/mean/max): 4.2519/6.1752/8.8478
 78%|█████████████████████████████████▎         | 31/40 [10:10<02:41, 17.94s/it]train - Mean loss: 0.906897    Avg. embedding norm: 29.6664   Triplets per batch (all/non-zero): 143.2/16.2
Pos dist (min/mean/max): 2.9117/4.7476/8.8536   Neg dist (min/mean/max): 4.7058/6.5630/9.6498
 80%|██████████████████████████████████▍        | 32/40 [10:28<02:23, 17.98s/it]train - Mean loss: 0.615705    Avg. embedding norm: 29.3842   Triplets per batch (all/non-zero): 143.6/23.6
Pos dist (min/mean/max): 2.6753/4.6988/7.7331   Neg dist (min/mean/max): 4.2904/6.2515/8.7172
 82%|███████████████████████████████████▍       | 33/40 [10:46<02:05, 18.00s/it]train - Mean loss: 0.704595    Avg. embedding norm: 29.5599   Triplets per batch (all/non-zero): 144.8/15.0
Pos dist (min/mean/max): 2.4854/4.7669/8.4561   Neg dist (min/mean/max): 4.7389/6.6310/10.0441
 85%|████████████████████████████████████▌      | 34/40 [11:04<01:48, 18.03s/it]train - Mean loss: 0.978079    Avg. embedding norm: 29.4964   Triplets per batch (all/non-zero): 143.6/14.4
Pos dist (min/mean/max): 2.8725/4.7575/8.5519   Neg dist (min/mean/max): 4.6046/6.6209/9.0323
 88%|█████████████████████████████████████▋     | 35/40 [11:22<01:30, 18.01s/it]train - Mean loss: 0.518637    Avg. embedding norm: 29.5081   Triplets per batch (all/non-zero): 145.6/13.2
Pos dist (min/mean/max): 2.6523/4.6549/7.6102   Neg dist (min/mean/max): 4.6889/6.5410/9.3605
 90%|██████████████████████████████████████▋    | 36/40 [11:40<01:12, 18.02s/it]train - Mean loss: 0.719000    Avg. embedding norm: 29.3878   Triplets per batch (all/non-zero): 144.4/28.0
Pos dist (min/mean/max): 2.4749/4.6825/8.3287   Neg dist (min/mean/max): 4.2489/5.9385/8.1297
 92%|███████████████████████████████████████▊   | 37/40 [11:58<00:54, 18.05s/it]train - Mean loss: 0.676500    Avg. embedding norm: 29.0837   Triplets per batch (all/non-zero): 146.4/15.8
Pos dist (min/mean/max): 2.7189/4.6320/8.0869   Neg dist (min/mean/max): 4.5470/6.3719/9.0571
 95%|████████████████████████████████████████▊  | 38/40 [12:16<00:36, 18.06s/it]train - Mean loss: 0.601688    Avg. embedding norm: 29.0916   Triplets per batch (all/non-zero): 144.8/21.4
Pos dist (min/mean/max): 2.6751/4.6961/7.7763   Neg dist (min/mean/max): 4.2125/6.0747/8.1609
 98%|█████████████████████████████████████████▉ | 39/40 [12:34<00:17, 17.86s/it]train - Mean loss: 0.569494    Avg. embedding norm: 29.5114   Triplets per batch (all/non-zero): 144.4/21.2
Pos dist (min/mean/max): 2.6356/4.6153/7.3973   Neg dist (min/mean/max): 4.3439/6.0970/8.7106
100%|███████████████████████████████████████████| 40/40 [12:51<00:00, 19.29s/it]

Extracting database sets embeddings
100%|█████████████████████████████████████████████| 2/2 [00:33<00:00, 16.84s/it]
Extracting query sets embeddings
100%|█████████████████████████████████████████████| 2/2 [00:06<00:00,  3.24s/it]
Final model:
Dataset: tum
Avg. top 1% recall: 88.37   Avg. similarity: 652.1308   Avg. recall @N:
[67.6989677  77.38927739 83.83283383 85.77256077 89.01098901 89.01098901
 90.95071595 90.95071595 90.95071595 91.6000666  91.6000666  92.24941725
 93.53979354 94.18081918 94.18081918 94.18081918 94.83016983 95.47119547
 95.47119547 95.47119547 96.12054612 96.12054612 96.76157176 97.41092241
 97.41092241]

root@ca9122f77af0:/home/xiayan/testdir/MinkLoc3D-SI/training#  cd /home/xiayan/testdir/MinkLoc3D-SI/eval ; /usr/bin/env /usr/bin/python /root/.vscode-server/extensions/ms-python.python-2022.6.2/pythonFiles/lib/python/debugpy/launcher 34575 -- evaluate.py --config=../config/config_baseline.txt --model_config=../models/minkloc_config.txt --weights=../weights/model_MinkFPN_GeM_20220529_1849_final.pth 
/opt/conda/lib/python3.8/site-packages/MinkowskiEngine-0.5.4-py3.8-linux-x86_64.egg/MinkowskiEngine/__init__.py:36: UserWarning: The environment variable `OMP_NUM_THREADS` not set. MinkowskiEngine will automatically set `OMP_NUM_THREADS=16`. If you want to set `OMP_NUM_THREADS` manually, please export it on the command line before running a python script. e.g. `export OMP_NUM_THREADS=12; python your_program.py`. It is recommended to set it below 24.
  warnings.warn(
Config path: ../config/config_baseline.txt
Model config path: ../models/minkloc_config.txt
Weights: ../weights/model_MinkFPN_GeM_20220529_1849_final.pth
Debug mode: False
Visualize: False
Log search results: False

Parameters:
params_path: ../config/config_baseline.txt
model_params_path: ../models/minkloc_config.txt
num_points: 4096
max_distance: 300
dataset_name: TUM
dataset_folder: ../../datasets/frame_5m_unnormalized
num_workers: 4
batch_size: 16
batch_expansion_th: 0.7
batch_size_limit: 158
batch_expansion_rate: 1.4
lr: 0.001
scheduler: MultiStepLR
scheduler_milestones: [30]
epochs: 40
weight_decay: 0.001
normalize_embeddings: False
loss: BatchHardTripletMarginLoss
margin: 0.2
aug_mode: 1
train_file: tum_training_queries_frame_5m_baseline.pickle
val_file: None
eval_database_files: ['tum_evaluation_frame_5m_database.pickle']
eval_query_files: ['tum_evaluation_frame_5m_query.pickle']
Model parameters:
model_params_path: ../models/minkloc_config.txt
model: MinkFPN_GeM
output_dim: 256
mink_quantization_size: [2.5, 2.0, 1.875]
version: MinkLoc3D-S
feature_size: 256
planes: [32, 64, 64]
combine_params: {'with_pnt': True, 'with_crosatt': False, 'with_way': 'cat', 'before_pooling': True}
layers: [1, 1, 1]
num_top_down: 1
conv0_kernel_size: 5


Device: cuda
Loading weights: ../weights/model_MinkFPN_GeM_20220529_1849_final.pth
Extracting database sets embeddings
100%|█████████████████████████████████████████████| 2/2 [00:45<00:00, 22.76s/it]
Extracting query sets embeddings
100%|█████████████████████████████████████████████| 2/2 [00:08<00:00,  4.05s/it]
Dataset: tum
Avg. top 1% recall: 90.33   Avg. similarity: 679.9563   Avg. recall @N:
[68.36496836 78.01365301 84.48218448 87.72893773 90.96736597 90.96736597
 91.60839161 92.25774226 92.25774226 93.54811855 93.54811855 94.18914419
 94.18914419 94.18914419 94.83016983 96.12054612 96.12054612 96.12054612
 96.12054612 96.12054612 96.12054612 96.76989677 97.41924742 97.41924742
 97.41924742]
root@ca9122f77af0:/home/xiayan/testdir/MinkLoc3D-SI/eval#  cd /home/xiayan/testdir/MinkLoc3D-SI/eval ; /usr/bin/env /usr/bin/python /root/.vscode-server/extensions/ms-python.python-2022.6.2/pythonFiles/lib/python/debugpy/launcher 35235 -- evaluate.py --config=../config/config_baseline.txt --model_config=../models/minkloc_config.txt --weights=../weights/model_MinkFPN_GeM_20220529_1849_final.pth 
/opt/conda/lib/python3.8/site-packages/MinkowskiEngine-0.5.4-py3.8-linux-x86_64.egg/MinkowskiEngine/__init__.py:36: UserWarning: The environment variable `OMP_NUM_THREADS` not set. MinkowskiEngine will automatically set `OMP_NUM_THREADS=16`. If you want to set `OMP_NUM_THREADS` manually, please export it on the command line before running a python script. e.g. `export OMP_NUM_THREADS=12; python your_program.py`. It is recommended to set it below 24.
  warnings.warn(
Config path: ../config/config_baseline.txt
Model config path: ../models/minkloc_config.txt
Weights: ../weights/model_MinkFPN_GeM_20220529_1849_final.pth
Debug mode: False
Visualize: False
Log search results: False

Parameters:
params_path: ../config/config_baseline.txt
model_params_path: ../models/minkloc_config.txt
num_points: 4096
max_distance: 300
dataset_name: TUM
dataset_folder: ../../datasets/frame_5m_unnormalized
num_workers: 4
batch_size: 16
batch_expansion_th: 0.7
batch_size_limit: 158
batch_expansion_rate: 1.4
lr: 0.001
scheduler: MultiStepLR
scheduler_milestones: [30]
epochs: 40
weight_decay: 0.001
normalize_embeddings: False
loss: BatchHardTripletMarginLoss
margin: 0.2
aug_mode: 1
train_file: tum_training_queries_frame_5m_baseline.pickle
val_file: None
eval_database_files: ['tum_evaluation_frame_5m_database.pickle']
eval_query_files: ['tum_evaluation_frame_5m_query.pickle']
Model parameters:
model_params_path: ../models/minkloc_config.txt
model: MinkFPN_GeM
output_dim: 256
mink_quantization_size: [2.5, 2.0, 1.875]
version: MinkLoc3D-S
feature_size: 256
planes: [32, 64, 64]
combine_params: {'with_pnt': True, 'with_crosatt': False, 'with_way': 'cat', 'before_pooling': True}
layers: [1, 1, 1]
num_top_down: 1
conv0_kernel_size: 5


Device: cuda
Loading weights: ../weights/model_MinkFPN_GeM_20220529_1849_final.pth
Extracting database sets embeddings
100%|█████████████████████████████████████████████| 2/2 [00:41<00:00, 20.94s/it]
Extracting query sets embeddings
100%|█████████████████████████████████████████████| 2/2 [00:07<00:00,  3.62s/it]
Dataset: tum
Avg. top 1% recall: 90.31   Avg. similarity: 667.8523   Avg. recall @N:
[67.71561772 79.95337995 84.47385947 89.01098901 90.95071595 90.95071595
 92.8987679  92.8987679  93.53979354 93.53979354 93.53979354 94.18081918
 94.83016983 95.47952048 95.47952048 95.47952048 95.47952048 96.12887113
 96.76989677 97.41092241 97.41092241 98.70962371 98.70962371 98.70962371
 98.70962371]
root@ca9122f77af0:/home/xiayan/testdir/MinkLoc3D-SI/eval#  cd /home/xiayan/testdir/MinkLoc3D-SI/eval ; /usr/bin/env /usr/bin/python /root/.vscode-server/extensions/ms-python.python-2022.6.2/pythonFiles/lib/python/debugpy/launcher 39871 -- evaluate.py --config=../config/config_baseline.txt --model_config=../models/minkloc_config.txt --weights=../weights/model_MinkFPN_GeM_20220529_1849_final.pth 
/opt/conda/lib/python3.8/site-packages/MinkowskiEngine-0.5.4-py3.8-linux-x86_64.egg/MinkowskiEngine/__init__.py:36: UserWarning: The environment variable `OMP_NUM_THREADS` not set. MinkowskiEngine will automatically set `OMP_NUM_THREADS=16`. If you want to set `OMP_NUM_THREADS` manually, please export it on the command line before running a python script. e.g. `export OMP_NUM_THREADS=12; python your_program.py`. It is recommended to set it below 24.
  warnings.warn(
Config path: ../config/config_baseline.txt
Model config path: ../models/minkloc_config.txt
Weights: ../weights/model_MinkFPN_GeM_20220529_1849_final.pth
Debug mode: False
Visualize: False
Log search results: False

Parameters:
params_path: ../config/config_baseline.txt
model_params_path: ../models/minkloc_config.txt
num_points: 4096
max_distance: 300
dataset_name: TUM
dataset_folder: ../../datasets/frame_5m_unnormalized
num_workers: 4
batch_size: 16
batch_expansion_th: 0.7
batch_size_limit: 158
batch_expansion_rate: 1.4
lr: 0.001
scheduler: MultiStepLR
scheduler_milestones: [30]
epochs: 40
weight_decay: 0.001
normalize_embeddings: False
loss: BatchHardTripletMarginLoss
margin: 0.2
aug_mode: 1
train_file: tum_training_queries_frame_5m_baseline.pickle
val_file: None
eval_database_files: ['tum_evaluation_frame_5m_database.pickle']
eval_query_files: ['tum_evaluation_frame_5m_query.pickle']
Model parameters:
model_params_path: ../models/minkloc_config.txt
model: MinkFPN_GeM
output_dim: 256
mink_quantization_size: [2.5, 2.0, 1.875]
version: MinkLoc3D-S
feature_size: 256
planes: [32, 64, 64]
combine_params: {'with_pnt': True, 'with_crosatt': False, 'with_way': 'cat', 'before_pooling': True}
layers: [1, 1, 1]
num_top_down: 1
conv0_kernel_size: 5


Device: cuda
Loading weights: ../weights/model_MinkFPN_GeM_20220529_1849_final.pth
Extracting database sets embeddings
100%|█████████████████████████████████████████████| 2/2 [00:45<00:00, 22.56s/it]
Extracting query sets embeddings
100%|█████████████████████████████████████████████| 2/2 [00:07<00:00,  3.71s/it]
Dataset: tum
Avg. top 1% recall: 90.33   Avg. similarity: 679.5938   Avg. recall @N:
[67.72394272 81.27705628 85.78921079 88.37828838 90.96736597 91.60839161
 92.8987679  92.8987679  92.8987679  93.54811855 94.1974692  94.1974692
 94.83849484 94.83849484 94.83849484 95.48784549 96.77822178 96.77822178
 96.77822178 96.77822178 96.77822178 97.41924742 98.06027306 98.06027306
 98.06027306]
root@ca9122f77af0:/home/xiayan/testdir/MinkLoc3D-SI/eval#  cd /home/xiayan/testdir/MinkLoc3D-SI/training ; /usr/bin/env /usr/bin/python /root/.vscode-server/extensions/ms-python.python-2022.6.2/pythonFiles/lib/python/debugpy/launcher 42561 -- train.py --config=../config/config_baseline.txt --model_config=../models/minkloc_config.txt 
/opt/conda/lib/python3.8/site-packages/MinkowskiEngine-0.5.4-py3.8-linux-x86_64.egg/MinkowskiEngine/__init__.py:36: UserWarning: The environment variable `OMP_NUM_THREADS` not set. MinkowskiEngine will automatically set `OMP_NUM_THREADS=16`. If you want to set `OMP_NUM_THREADS` manually, please export it on the command line before running a python script. e.g. `export OMP_NUM_THREADS=12; python your_program.py`. It is recommended to set it below 24.
  warnings.warn(