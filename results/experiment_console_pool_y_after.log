/opt/conda/lib/python3.8/site-packages/MinkowskiEngine-0.5.4-py3.8-linux-x86_64.egg/MinkowskiEngine/__init__.py:36: UserWarning: The environment variable `OMP_NUM_THREADS` not set. MinkowskiEngine will automatically set `OMP_NUM_THREADS=16`. If you want to set `OMP_NUM_THREADS` manually, please export it on the command line before running a python script. e.g. `export OMP_NUM_THREADS=12; python your_program.py`. It is recommended to set it below 24.
  warnings.warn(
Training config path: ../config/config_baseline.txt
Model config path: ../models/minkloc_config.txt
Debug mode: False
Visualize: False
Parameters:
params_path: ../config/config_baseline.txt
model_params_path: ../models/minkloc_config.txt
num_points: 4096
max_distance: 300
dataset_name: TUM
dataset_folder: ../../datasets/frame_5m_unnormalized
num_workers: 4
batch_size: 16
batch_expansion_th: 0.7
batch_size_limit: 158
batch_expansion_rate: 1.4
lr: 0.001
scheduler: MultiStepLR
scheduler_milestones: [30]
epochs: 40
weight_decay: 0.001
normalize_embeddings: False
loss: BatchHardTripletMarginLoss
margin: 0.2
aug_mode: 1
train_file: tum_training_queries_frame_5m_baseline.pickle
val_file: None
eval_database_files: ['tum_evaluation_frame_5m_database.pickle']
eval_query_files: ['tum_evaluation_frame_5m_query.pickle']
Model parameters:
model_params_path: ../models/minkloc_config.txt
model: MinkFPN_GeM
output_dim: 256
mink_quantization_size: [2.5, 2.0, 1.875]
version: MinkLoc3D-S
feature_size: 256
planes: [32, 64, 64]
combine_params: {'with_pnt': True, 'with_crosatt': False, 'with_way': 'cat', 'before_pooling': True}
layers: [1, 1, 1]
num_top_down: 1
conv0_kernel_size: 5


Loading preprocessed query file: ../../datasets/frame_5m_unnormalized/tum_training_queries_frame_5m_baseline_cached.pickle...
667 queries in the dataset
Model name: model_MinkFPN_GeM_20220529_1914
Model class: MinkLoc
Total parameters: 3759274
Backbone parameters: 1055712
Aggregation parameters: 1
Model device: cuda
  0%|                                                    | 0/40 [00:00<?, ?it/s]train - Mean loss: 1.328145    Avg. embedding norm: 32.7973   Triplets per batch (all/non-zero): 15.7/6.0
Pos dist (min/mean/max): 3.6986/5.5462/8.9543   Neg dist (min/mean/max): 4.5985/6.2980/10.2091
=> Batch size increased from: 16 to 22
  2%|█                                           | 1/40 [00:44<28:50, 44.36s/it]train - Mean loss: 1.243312    Avg. embedding norm: 34.3095   Triplets per batch (all/non-zero): 22.0/5.6
Pos dist (min/mean/max): 3.5369/5.4020/8.4847   Neg dist (min/mean/max): 4.9619/6.7154/9.5218
=> Batch size increased from: 22 to 30
  5%|██▏                                         | 2/40 [01:16<23:36, 37.27s/it]train - Mean loss: 0.963232    Avg. embedding norm: 33.8930   Triplets per batch (all/non-zero): 29.8/8.0
Pos dist (min/mean/max): 3.3365/5.1361/7.7624   Neg dist (min/mean/max): 4.7299/6.2645/9.1224
=> Batch size increased from: 30 to 42
  8%|███▎                                        | 3/40 [01:41<19:22, 31.41s/it]train - Mean loss: 0.912051    Avg. embedding norm: 33.7032   Triplets per batch (all/non-zero): 40.0/10.7
Pos dist (min/mean/max): 3.4416/5.1935/8.3058   Neg dist (min/mean/max): 4.7200/6.3192/9.1199
=> Batch size increased from: 42 to 58
 10%|████▍                                       | 4/40 [02:02<16:34, 27.63s/it]train - Mean loss: 0.973445    Avg. embedding norm: 33.2906   Triplets per batch (all/non-zero): 56.6/14.3
Pos dist (min/mean/max): 3.2590/5.2759/9.3236   Neg dist (min/mean/max): 4.5534/6.3752/9.6905
=> Batch size increased from: 58 to 81
 12%|█████▌                                      | 5/40 [02:23<14:41, 25.18s/it]train - Mean loss: 1.037703    Avg. embedding norm: 33.2515   Triplets per batch (all/non-zero): 81.1/21.1
Pos dist (min/mean/max): 3.1386/5.3095/9.6920   Neg dist (min/mean/max): 4.2721/6.3569/9.4586
=> Batch size increased from: 81 to 113
 15%|██████▌                                     | 6/40 [02:42<13:06, 23.13s/it]train - Mean loss: 1.273737    Avg. embedding norm: 32.9479   Triplets per batch (all/non-zero): 102.6/31.6
Pos dist (min/mean/max): 3.0914/5.5174/11.4127   Neg dist (min/mean/max): 4.4158/6.4196/10.2966
=> Batch size increased from: 113 to 158
 18%|███████▋                                    | 7/40 [03:01<11:58, 21.77s/it]train - Mean loss: 1.011500    Avg. embedding norm: 32.9622   Triplets per batch (all/non-zero): 145.2/42.2
Pos dist (min/mean/max): 2.9731/5.3004/9.1793   Neg dist (min/mean/max): 4.1304/6.1131/8.8551
 20%|████████▊                                   | 8/40 [03:20<11:04, 20.77s/it]train - Mean loss: 0.882809    Avg. embedding norm: 32.1056   Triplets per batch (all/non-zero): 145.2/43.4
Pos dist (min/mean/max): 2.9499/5.2274/9.3092   Neg dist (min/mean/max): 4.2022/6.1048/9.4933
 22%|█████████▉                                  | 9/40 [03:39<10:25, 20.16s/it]train - Mean loss: 0.807976    Avg. embedding norm: 32.0894   Triplets per batch (all/non-zero): 144.4/35.2
Pos dist (min/mean/max): 3.1695/5.0833/8.7578   Neg dist (min/mean/max): 4.2484/5.9478/8.4390
 25%|██████████▊                                | 10/40 [03:57<09:49, 19.66s/it]train - Mean loss: 0.874059    Avg. embedding norm: 31.2618   Triplets per batch (all/non-zero): 145.2/37.0
Pos dist (min/mean/max): 2.9908/5.1119/9.9055   Neg dist (min/mean/max): 4.3056/6.0869/10.3378
 28%|███████████▊                               | 11/40 [04:16<09:21, 19.35s/it]train - Mean loss: 0.870807    Avg. embedding norm: 31.3073   Triplets per batch (all/non-zero): 146.8/41.4
Pos dist (min/mean/max): 2.9515/5.0288/9.2430   Neg dist (min/mean/max): 3.9083/5.9289/8.8639
 30%|████████████▉                              | 12/40 [04:35<08:54, 19.09s/it]train - Mean loss: 1.017334    Avg. embedding norm: 30.7515   Triplets per batch (all/non-zero): 144.0/32.4
Pos dist (min/mean/max): 2.7084/5.0621/10.5679   Neg dist (min/mean/max): 4.2090/6.1374/9.2153
 32%|█████████████▉                             | 13/40 [04:53<08:33, 19.01s/it]train - Mean loss: 0.929633    Avg. embedding norm: 31.2305   Triplets per batch (all/non-zero): 144.8/29.6
Pos dist (min/mean/max): 2.6719/5.0932/9.4756   Neg dist (min/mean/max): 4.4810/6.1753/8.4771
 35%|███████████████                            | 14/40 [05:12<08:10, 18.85s/it]train - Mean loss: 0.920239    Avg. embedding norm: 30.7513   Triplets per batch (all/non-zero): 145.2/31.4
Pos dist (min/mean/max): 2.8036/5.0386/9.8860   Neg dist (min/mean/max): 4.1827/6.2223/9.5859
 38%|████████████████▏                          | 15/40 [05:30<07:48, 18.73s/it]train - Mean loss: 0.820301    Avg. embedding norm: 30.5601   Triplets per batch (all/non-zero): 144.4/25.8
Pos dist (min/mean/max): 2.8515/4.9719/9.9513   Neg dist (min/mean/max): 4.2332/6.2092/9.9632
 40%|█████████████████▏                         | 16/40 [05:49<07:26, 18.62s/it]train - Mean loss: 0.833995    Avg. embedding norm: 30.5749   Triplets per batch (all/non-zero): 146.0/17.2
Pos dist (min/mean/max): 2.8291/4.8166/8.5431   Neg dist (min/mean/max): 4.2476/6.2269/8.8109
 42%|██████████████████▎                        | 17/40 [06:07<07:06, 18.53s/it]train - Mean loss: 0.810103    Avg. embedding norm: 30.8067   Triplets per batch (all/non-zero): 145.2/22.0
Pos dist (min/mean/max): 2.9036/4.9683/8.9963   Neg dist (min/mean/max): 4.5511/6.3429/8.6751
 45%|███████████████████▎                       | 18/40 [06:25<06:46, 18.46s/it]train - Mean loss: 0.872262    Avg. embedding norm: 30.5941   Triplets per batch (all/non-zero): 142.4/35.2
Pos dist (min/mean/max): 2.9346/4.9869/10.0013   Neg dist (min/mean/max): 4.3535/6.1611/8.7958
 48%|████████████████████▍                      | 19/40 [06:43<06:25, 18.36s/it]train - Mean loss: 0.742822    Avg. embedding norm: 30.1195   Triplets per batch (all/non-zero): 144.4/26.8
Pos dist (min/mean/max): 2.8812/4.9414/8.5293   Neg dist (min/mean/max): 4.4308/6.2297/8.8708
 50%|█████████████████████▌                     | 20/40 [07:02<06:07, 18.40s/it]train - Mean loss: 0.912830    Avg. embedding norm: 29.9615   Triplets per batch (all/non-zero): 144.0/30.8
Pos dist (min/mean/max): 2.8372/4.9986/10.3186   Neg dist (min/mean/max): 4.4181/6.0798/8.8415
 52%|██████████████████████▌                    | 21/40 [07:20<05:49, 18.40s/it]train - Mean loss: 0.741876    Avg. embedding norm: 30.3279   Triplets per batch (all/non-zero): 144.8/22.6
Pos dist (min/mean/max): 2.8072/4.8796/8.6049   Neg dist (min/mean/max): 4.5805/6.3168/9.4568
 55%|███████████████████████▋                   | 22/40 [07:39<05:31, 18.41s/it]train - Mean loss: 0.851797    Avg. embedding norm: 30.4417   Triplets per batch (all/non-zero): 143.6/11.4
Pos dist (min/mean/max): 2.7277/4.7960/8.9317   Neg dist (min/mean/max): 4.7925/6.4977/9.2191
 57%|████████████████████████▋                  | 23/40 [07:57<05:14, 18.49s/it]train - Mean loss: 1.022101    Avg. embedding norm: 30.8537   Triplets per batch (all/non-zero): 145.6/24.0
Pos dist (min/mean/max): 2.8777/5.0407/9.7460   Neg dist (min/mean/max): 4.5320/6.3991/10.0258
 60%|█████████████████████████▊                 | 24/40 [08:16<04:54, 18.42s/it]train - Mean loss: 0.929671    Avg. embedding norm: 31.3216   Triplets per batch (all/non-zero): 142.8/21.8
Pos dist (min/mean/max): 2.7913/5.0875/9.2932   Neg dist (min/mean/max): 4.4202/6.4887/9.6106
 62%|██████████████████████████▉                | 25/40 [08:34<04:35, 18.40s/it]train - Mean loss: 0.650520    Avg. embedding norm: 31.4041   Triplets per batch (all/non-zero): 144.8/16.0
Pos dist (min/mean/max): 2.9816/5.0266/8.5754   Neg dist (min/mean/max): 4.5461/6.6593/9.3008
 65%|███████████████████████████▉               | 26/40 [08:53<04:18, 18.45s/it]train - Mean loss: 0.760945    Avg. embedding norm: 31.3642   Triplets per batch (all/non-zero): 143.6/18.4
Pos dist (min/mean/max): 2.8906/5.0411/8.5717   Neg dist (min/mean/max): 4.8045/6.6536/10.1936
 68%|█████████████████████████████              | 27/40 [09:11<03:59, 18.43s/it]train - Mean loss: 0.926498    Avg. embedding norm: 31.3440   Triplets per batch (all/non-zero): 145.2/19.8
Pos dist (min/mean/max): 2.8421/5.1414/9.8871   Neg dist (min/mean/max): 4.8727/6.8220/10.2313
 70%|██████████████████████████████             | 28/40 [09:30<03:42, 18.57s/it]train - Mean loss: 0.722749    Avg. embedding norm: 31.3448   Triplets per batch (all/non-zero): 147.2/28.6
Pos dist (min/mean/max): 2.8854/5.2050/9.1254   Neg dist (min/mean/max): 4.6473/6.7401/9.0969
 72%|███████████████████████████████▏           | 29/40 [09:48<03:23, 18.47s/it]train - Mean loss: 0.767029    Avg. embedding norm: 31.2694   Triplets per batch (all/non-zero): 143.6/21.0
Pos dist (min/mean/max): 2.6911/5.1080/8.4900   Neg dist (min/mean/max): 4.8060/6.5407/9.0267
 75%|████████████████████████████████▎          | 30/40 [10:06<03:03, 18.39s/it]train - Mean loss: 0.736445    Avg. embedding norm: 31.1495   Triplets per batch (all/non-zero): 144.0/24.0
Pos dist (min/mean/max): 2.7430/5.0193/8.7567   Neg dist (min/mean/max): 4.2051/6.2842/8.5744
 78%|█████████████████████████████████▎         | 31/40 [10:25<02:46, 18.47s/it]train - Mean loss: 0.936770    Avg. embedding norm: 31.2824   Triplets per batch (all/non-zero): 143.2/20.6
Pos dist (min/mean/max): 2.8880/4.9294/8.6918   Neg dist (min/mean/max): 4.8259/6.5993/8.9518
 80%|██████████████████████████████████▍        | 32/40 [10:44<02:28, 18.51s/it]train - Mean loss: 0.822943    Avg. embedding norm: 31.0148   Triplets per batch (all/non-zero): 143.6/23.8
Pos dist (min/mean/max): 2.9556/4.9814/8.6801   Neg dist (min/mean/max): 4.3298/6.3803/8.5796
 82%|███████████████████████████████████▍       | 33/40 [11:05<02:15, 19.33s/it]train - Mean loss: 0.748092    Avg. embedding norm: 31.1393   Triplets per batch (all/non-zero): 144.8/15.4
Pos dist (min/mean/max): 2.7423/4.9898/9.3591   Neg dist (min/mean/max): 4.9548/6.7176/8.9591
 85%|████████████████████████████████████▌      | 34/40 [11:26<01:59, 19.90s/it]train - Mean loss: 0.966962    Avg. embedding norm: 31.0181   Triplets per batch (all/non-zero): 143.6/16.4
Pos dist (min/mean/max): 2.8873/4.9713/9.7489   Neg dist (min/mean/max): 4.6240/6.6230/8.8803
 88%|█████████████████████████████████████▋     | 35/40 [11:47<01:41, 20.24s/it]train - Mean loss: 0.607537    Avg. embedding norm: 31.1096   Triplets per batch (all/non-zero): 145.6/17.2
Pos dist (min/mean/max): 2.6496/4.9324/8.0651   Neg dist (min/mean/max): 4.7732/6.6183/8.5143
 90%|██████████████████████████████████████▋    | 36/40 [12:08<01:21, 20.45s/it]train - Mean loss: 0.686100    Avg. embedding norm: 30.8767   Triplets per batch (all/non-zero): 144.4/24.2
Pos dist (min/mean/max): 2.8399/4.9781/8.4348   Neg dist (min/mean/max): 4.7407/6.3418/8.3694
 92%|███████████████████████████████████████▊   | 37/40 [12:30<01:02, 20.79s/it]train - Mean loss: 1.056860    Avg. embedding norm: 30.6810   Triplets per batch (all/non-zero): 146.4/14.8
Pos dist (min/mean/max): 2.7967/4.9352/10.5171   Neg dist (min/mean/max): 4.7279/6.5739/8.9461
 95%|████████████████████████████████████████▊  | 38/40 [12:51<00:41, 20.89s/it]train - Mean loss: 0.650868    Avg. embedding norm: 30.7176   Triplets per batch (all/non-zero): 144.8/20.4
Pos dist (min/mean/max): 2.8679/4.9737/8.5726   Neg dist (min/mean/max): 4.4458/6.4247/8.2785
 98%|█████████████████████████████████████████▉ | 39/40 [13:12<00:20, 20.97s/it]train - Mean loss: 0.489362    Avg. embedding norm: 30.9954   Triplets per batch (all/non-zero): 144.4/21.8
Pos dist (min/mean/max): 2.8653/4.8785/7.7039   Neg dist (min/mean/max): 4.7177/6.4100/8.5532
100%|███████████████████████████████████████████| 40/40 [13:33<00:00, 20.35s/it]

Extracting database sets embeddings
100%|█████████████████████████████████████████████| 2/2 [00:46<00:00, 23.20s/it]
Extracting query sets embeddings
100%|█████████████████████████████████████████████| 2/2 [00:07<00:00,  3.68s/it]
Final model:
Dataset: tum
Avg. top 1% recall: 88.39   Avg. similarity: 877.3129   Avg. recall @N:
[69.03096903 82.57575758 85.80586081 87.08791209 88.38661339 90.32634033
 90.96736597 92.25774226 92.25774226 92.25774226 92.8987679  93.53979354
 93.53979354 94.18914419 94.83849484 94.83849484 94.83849484 94.83849484
 94.83849484 94.83849484 94.83849484 94.83849484 94.83849484 94.83849484
 95.47952048]

 /opt/conda/lib/python3.8/site-packages/MinkowskiEngine-0.5.4-py3.8-linux-x86_64.egg/MinkowskiEngine/__init__.py:36: UserWarning: The environment variable `OMP_NUM_THREADS` not set. MinkowskiEngine will automatically set `OMP_NUM_THREADS=16`. If you want to set `OMP_NUM_THREADS` manually, please export it on the command line before running a python script. e.g. `export OMP_NUM_THREADS=12; python your_program.py`. It is recommended to set it below 24.
  warnings.warn(
Config path: ../config/config_baseline.txt
Model config path: ../models/minkloc_config.txt
Weights: ../weights/model_MinkFPN_GeM_20220529_1914_final.pth
Debug mode: False
Visualize: False
Log search results: False

Parameters:
params_path: ../config/config_baseline.txt
model_params_path: ../models/minkloc_config.txt
num_points: 4096
max_distance: 300
dataset_name: TUM
dataset_folder: ../../datasets/frame_5m_unnormalized
num_workers: 4
batch_size: 16
batch_expansion_th: 0.7
batch_size_limit: 158
batch_expansion_rate: 1.4
lr: 0.001
scheduler: MultiStepLR
scheduler_milestones: [30]
epochs: 40
weight_decay: 0.001
normalize_embeddings: False
loss: BatchHardTripletMarginLoss
margin: 0.2
aug_mode: 1
train_file: tum_training_queries_frame_5m_baseline.pickle
val_file: None
eval_database_files: ['tum_evaluation_frame_5m_database.pickle']
eval_query_files: ['tum_evaluation_frame_5m_query.pickle']
Model parameters:
model_params_path: ../models/minkloc_config.txt
model: MinkFPN_GeM
output_dim: 256
mink_quantization_size: [2.5, 2.0, 1.875]
version: MinkLoc3D-S
feature_size: 256
planes: [32, 64, 64]
combine_params: {'with_pnt': True, 'with_crosatt': False, 'with_way': 'cat', 'before_pooling': True}
layers: [1, 1, 1]
num_top_down: 1
conv0_kernel_size: 5


Device: cuda
Loading weights: ../weights/model_MinkFPN_GeM_20220529_1914_final.pth
Extracting database sets embeddings
100%|█████████████████████████████████████████████| 2/2 [00:47<00:00, 23.96s/it]
Extracting query sets embeddings
100%|█████████████████████████████████████████████| 2/2 [00:07<00:00,  3.90s/it]
Dataset: tum
Avg. top 1% recall: 90.32   Avg. similarity: 872.1406   Avg. recall @N:
[68.38161838 83.20845821 85.7975358  89.66866467 90.95904096 91.60839161
 91.60839161 92.8987679  92.8987679  92.8987679  92.8987679  92.8987679
 93.53979354 93.53979354 93.53979354 93.53979354 93.53979354 94.18914419
 94.18914419 94.18914419 94.18914419 94.18914419 94.18914419 95.47952048
 96.12054612]
root@ca9122f77af0:/home/xiayan/testdir/MinkLoc3D-SI/eval#  cd /home/xiayan/testdir/MinkLoc3D-SI/eval ; /usr/bin/env /usr/bin/python /root/.vscode-server/extensions/ms-python.python-2022.6.2/pythonFiles/lib/python/debugpy/launcher 33031 -- evaluate.py --config=../config/config_baseline.txt --model_config=../models/minkloc_config.txt --weights=../weights/model_MinkFPN_GeM_20220529_1914_final.pth 
/opt/conda/lib/python3.8/site-packages/MinkowskiEngine-0.5.4-py3.8-linux-x86_64.egg/MinkowskiEngine/__init__.py:36: UserWarning: The environment variable `OMP_NUM_THREADS` not set. MinkowskiEngine will automatically set `OMP_NUM_THREADS=16`. If you want to set `OMP_NUM_THREADS` manually, please export it on the command line before running a python script. e.g. `export OMP_NUM_THREADS=12; python your_program.py`. It is recommended to set it below 24.
  warnings.warn(
Config path: ../config/config_baseline.txt
Model config path: ../models/minkloc_config.txt
Weights: ../weights/model_MinkFPN_GeM_20220529_1914_final.pth
Debug mode: False
Visualize: False
Log search results: False

Parameters:
params_path: ../config/config_baseline.txt
model_params_path: ../models/minkloc_config.txt
num_points: 4096
max_distance: 300
dataset_name: TUM
dataset_folder: ../../datasets/frame_5m_unnormalized
num_workers: 4
batch_size: 16
batch_expansion_th: 0.7
batch_size_limit: 158
batch_expansion_rate: 1.4
lr: 0.001
scheduler: MultiStepLR
scheduler_milestones: [30]
epochs: 40
weight_decay: 0.001
normalize_embeddings: False
loss: BatchHardTripletMarginLoss
margin: 0.2
aug_mode: 1
train_file: tum_training_queries_frame_5m_baseline.pickle
val_file: None
eval_database_files: ['tum_evaluation_frame_5m_database.pickle']
eval_query_files: ['tum_evaluation_frame_5m_query.pickle']
Model parameters:
model_params_path: ../models/minkloc_config.txt
model: MinkFPN_GeM
output_dim: 256
mink_quantization_size: [2.5, 2.0, 1.875]
version: MinkLoc3D-S
feature_size: 256
planes: [32, 64, 64]
combine_params: {'with_pnt': True, 'with_crosatt': False, 'with_way': 'cat', 'before_pooling': True}
layers: [1, 1, 1]
num_top_down: 1
conv0_kernel_size: 5


Device: cuda
Loading weights: ../weights/model_MinkFPN_GeM_20220529_1914_final.pth
Extracting database sets embeddings
100%|█████████████████████████████████████████████| 2/2 [00:46<00:00, 23.23s/it]
Extracting query sets embeddings
100%|█████████████████████████████████████████████| 2/2 [00:07<00:00,  3.66s/it]
Dataset: tum
Avg. top 1% recall: 89.68   Avg. similarity: 866.7200   Avg. recall @N:
[68.38161838 80.64435564 85.80586081 89.02763903 90.31801532 90.31801532
 91.6000666  92.24941725 92.8987679  92.8987679  92.8987679  93.53979354
 93.53979354 93.53979354 93.53979354 93.53979354 93.53979354 94.18914419
 94.18914419 94.18914419 94.18914419 94.18914419 94.83016983 94.83016983
 95.47952048]
root@ca9122f77af0:/home/xiayan/testdir/MinkLoc3D-SI/eval#  cd /home/xiayan/testdir/MinkLoc3D-SI/eval ; /usr/bin/env /usr/bin/python /root/.vscode-server/extensions/ms-python.python-2022.6.2/pythonFiles/lib/python/debugpy/launcher 39911 -- evaluate.py --config=../config/config_baseline.txt --model_config=../models/minkloc_config.txt --weights=../weights/model_MinkFPN_GeM_20220529_1914_final.pth 
/opt/conda/lib/python3.8/site-packages/MinkowskiEngine-0.5.4-py3.8-linux-x86_64.egg/MinkowskiEngine/__init__.py:36: UserWarning: The environment variable `OMP_NUM_THREADS` not set. MinkowskiEngine will automatically set `OMP_NUM_THREADS=16`. If you want to set `OMP_NUM_THREADS` manually, please export it on the command line before running a python script. e.g. `export OMP_NUM_THREADS=12; python your_program.py`. It is recommended to set it below 24.
  warnings.warn(
Config path: ../config/config_baseline.txt
Model config path: ../models/minkloc_config.txt
Weights: ../weights/model_MinkFPN_GeM_20220529_1914_final.pth
Debug mode: False
Visualize: False
Log search results: False

Parameters:
params_path: ../config/config_baseline.txt
model_params_path: ../models/minkloc_config.txt
num_points: 4096
max_distance: 300
dataset_name: TUM
dataset_folder: ../../datasets/frame_5m_unnormalized
num_workers: 4
batch_size: 16
batch_expansion_th: 0.7
batch_size_limit: 158
batch_expansion_rate: 1.4
lr: 0.001
scheduler: MultiStepLR
scheduler_milestones: [30]
epochs: 40
weight_decay: 0.001
normalize_embeddings: False
loss: BatchHardTripletMarginLoss
margin: 0.2
aug_mode: 1
train_file: tum_training_queries_frame_5m_baseline.pickle
val_file: None
eval_database_files: ['tum_evaluation_frame_5m_database.pickle']
eval_query_files: ['tum_evaluation_frame_5m_query.pickle']
Model parameters:
model_params_path: ../models/minkloc_config.txt
model: MinkFPN_GeM
output_dim: 256
mink_quantization_size: [2.5, 2.0, 1.875]
version: MinkLoc3D-S
feature_size: 256
planes: [32, 64, 64]
combine_params: {'with_pnt': True, 'with_crosatt': False, 'with_way': 'cat', 'before_pooling': True}
layers: [1, 1, 1]
num_top_down: 1
conv0_kernel_size: 5


Device: cuda
Loading weights: ../weights/model_MinkFPN_GeM_20220529_1914_final.pth
Extracting database sets embeddings
100%|█████████████████████████████████████████████| 2/2 [00:45<00:00, 22.81s/it]
Extracting query sets embeddings
100%|█████████████████████████████████████████████| 2/2 [00:07<00:00,  3.60s/it]
Dataset: tum
Avg. top 1% recall: 90.33   Avg. similarity: 888.0880   Avg. recall @N:
[66.45021645 81.92640693 84.4988345  89.67698968 90.96736597 90.96736597
 92.8987679  92.8987679  92.8987679  92.8987679  93.54811855 93.54811855
 93.54811855 94.83016983 94.83016983 94.83016983 94.83016983 95.47952048
 96.12887113 96.12887113 96.12887113 96.12887113 96.12887113 96.12887113
 96.76989677]
root@ca9122f77af0:/home/xiayan/testdir/MinkLoc3D-SI/eval#  cd /home/xiayan/testdir/MinkLoc3D-SI/eval ; /usr/bin/env /usr/bin/python /root/.vscode-server/extensions/ms-python.python-2022.6.2/pythonFiles/lib/python/debugpy/launcher 40721 -- evaluate.py --config=../config/config_baseline.txt --model_config=../models/minkloc_config.txt --weights=../weights/model_MinkFPN_GeM_20220529_1914_final.pth 
/opt/conda/lib/python3.8/site-packages/MinkowskiEngine-0.5.4-py3.8-linux-x86_64.egg/MinkowskiEngine/__init__.py:36: UserWarning: The environment variable `OMP_NUM_THREADS` not set. MinkowskiEngine will automatically set `OMP_NUM_THREADS=16`. If you want to set `OMP_NUM_THREADS` manually, please export it on the command line before running a python script. e.g. `export OMP_NUM_THREADS=12; python your_program.py`. It is recommended to set it below 24.
  warnings.warn(
Config path: ../config/config_baseline.txt
Model config path: ../models/minkloc_config.txt
Weights: ../weights/model_MinkFPN_GeM_20220529_1914_final.pth
Debug mode: False
Visualize: False
Log search results: False

Parameters:
params_path: ../config/config_baseline.txt
model_params_path: ../models/minkloc_config.txt
num_points: 4096
max_distance: 300
dataset_name: TUM
dataset_folder: ../../datasets/frame_5m_unnormalized
num_workers: 4
batch_size: 16
batch_expansion_th: 0.7
batch_size_limit: 158
batch_expansion_rate: 1.4
lr: 0.001
scheduler: MultiStepLR
scheduler_milestones: [30]
epochs: 40
weight_decay: 0.001
normalize_embeddings: False
loss: BatchHardTripletMarginLoss
margin: 0.2
aug_mode: 1
train_file: tum_training_queries_frame_5m_baseline.pickle
val_file: None
eval_database_files: ['tum_evaluation_frame_5m_database.pickle']
eval_query_files: ['tum_evaluation_frame_5m_query.pickle']
Model parameters:
model_params_path: ../models/minkloc_config.txt
model: MinkFPN_GeM
output_dim: 256
mink_quantization_size: [2.5, 2.0, 1.875]
version: MinkLoc3D-S
feature_size: 256
planes: [32, 64, 64]
combine_params: {'with_pnt': True, 'with_crosatt': False, 'with_way': 'cat', 'before_pooling': True}
layers: [1, 1, 1]
num_top_down: 1
conv0_kernel_size: 5


Device: cuda
Loading weights: ../weights/model_MinkFPN_GeM_20220529_1914_final.pth
Extracting database sets embeddings
100%|█████████████████████████████████████████████| 2/2 [00:46<00:00, 23.38s/it]
Extracting query sets embeddings
100%|█████████████████████████████████████████████| 2/2 [00:08<00:00,  4.10s/it]
Dataset: tum
Avg. top 1% recall: 89.03   Avg. similarity: 885.3013   Avg. recall @N:
[66.45021645 81.92640693 85.14818515 87.72893773 89.66866467 92.25774226
 92.25774226 92.8987679  92.8987679  93.54811855 93.54811855 94.83849484
 94.83849484 94.83849484 94.83849484 94.83849484 94.83849484 94.83849484
 94.83849484 96.12887113 96.12887113 96.76989677 96.76989677 96.76989677
 96.76989677]